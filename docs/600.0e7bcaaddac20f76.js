"use strict";(self.webpackChunkapp1=self.webpackChunkapp1||[]).push([[600],{600:(E,g,d)=>{d.r(g),d.d(g,{OrdersModule:()=>Q});var p=d(6895),c=d(1483),e=d(4650),_=d(529);let u=(()=>{class r{constructor(t){this._httpClient=t}createCashOrder(t,i){return this._httpClient.post(`https://ecommerce.routemisr.com/api/v1/orders/${t}`,{shippingAddress:i})}getAllOrders(){return this._httpClient.get("https://ecommerce.routemisr.com/api/v1/orders/")}getUserOrders(t){return this._httpClient.get(`https://ecommerce.routemisr.com/api/v1/orders/user/${t}`)}goToOnlinepayment(t,i){return this._httpClient.post(`https://ecommerce.routemisr.com/api/v1/orders/checkout-session/${t}?url=http://localhost:4200`,{shippingAddress:i})}}return r.\u0275fac=function(t){return new(t||r)(e.LFG(_.eN))},r.\u0275prov=e.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})(),m=(()=>{class r{transform(t,...i){return new Date(t)}}return r.\u0275fac=function(t){return new(t||r)},r.\u0275pipe=e.Yjl({name:"getDate",type:r,pure:!0}),r})(),h=(()=>{class r{transform(t,...i){return 1==t?"Paid":"Not Paid"}}return r.\u0275fac=function(t){return new(t||r)},r.\u0275pipe=e.Yjl({name:"paidOrder",type:r,pure:!0}),r})();function Z(r,s){1&r&&(e.TgZ(0,"div",4)(1,"h4",5),e._uU(2,"You have no previous orders"),e.qZA(),e.TgZ(3,"p"),e._uU(4," We have many items available across our wide range of sellers. Start ordering today! "),e.qZA(),e.TgZ(5,"button",6)(6,"a",7),e._uU(7,"Continue shopping "),e.qZA()()())}function f(r,s){if(1&r){const t=e.EpF();e.TgZ(0,"div")(1,"button",13),e.NdJ("click",function(){const l=e.CHM(t).$implicit,a=e.oxw(2);return e.KtG(a.showDetils(l._id))}),e._uU(2),e.qZA()()}if(2&r){const t=s.index;e.xp6(2),e.hij(" Order ",t+1," ")}}function A(r,s){if(1&r&&(e.TgZ(0,"p"),e._UZ(1,"img",16),e.TgZ(2,"span"),e._uU(3),e.qZA(),e.TgZ(4,"span"),e._uU(5),e.qZA()()),2&r){const t=s.$implicit;e.xp6(1),e.Q6J("src",t.product.imageCover,e.LSH),e.xp6(2),e.hij("",t.product.title," /"),e.xp6(2),e.hij("qty(",t.count,")")}}function T(r,s){if(1&r&&(e.TgZ(0,"div",14)(1,"div",15)(2,"table")(3,"tr")(4,"td"),e._uU(5,"Total Order Price"),e.qZA(),e.TgZ(6,"td"),e._uU(7,":"),e.qZA(),e.TgZ(8,"td"),e._uU(9),e.qZA()(),e.TgZ(10,"tr")(11,"td"),e._uU(12,"Payment Method Type"),e.qZA(),e.TgZ(13,"td"),e._uU(14,":"),e.qZA(),e.TgZ(15,"td"),e._uU(16),e.qZA()(),e.TgZ(17,"tr")(18,"td"),e._uU(19,"Is Paid"),e.qZA(),e.TgZ(20,"td"),e._uU(21,":"),e.qZA(),e.TgZ(22,"td"),e._uU(23),e.ALo(24,"paidOrder"),e.qZA()(),e.TgZ(25,"tr")(26,"td"),e._uU(27,"Shipping Price"),e.qZA(),e.TgZ(28,"td"),e._uU(29,":"),e.qZA(),e.TgZ(30,"td"),e._uU(31),e.qZA()(),e.TgZ(32,"tr")(33,"td"),e._uU(34,"Tax Price"),e.qZA(),e.TgZ(35,"td"),e._uU(36,":"),e.qZA(),e.TgZ(37,"td"),e._uU(38),e.qZA()(),e.TgZ(39,"tr")(40,"td"),e._uU(41,"Created At"),e.qZA(),e.TgZ(42,"td"),e._uU(43,":"),e.qZA(),e.TgZ(44,"td"),e._uU(45),e.ALo(46,"getDate"),e.qZA()(),e.TgZ(47,"tr")(48,"td"),e._uU(49,"Shipping Address"),e.qZA(),e.TgZ(50,"td"),e._uU(51,":"),e.qZA(),e.TgZ(52,"td"),e._uU(53),e.qZA()(),e.TgZ(54,"tr")(55,"td"),e._uU(56,"Order Items"),e.qZA(),e.TgZ(57,"td"),e._uU(58,":"),e.qZA(),e.TgZ(59,"td"),e.YNc(60,A,6,3,"p",11),e.qZA()()()()()),2&r){const t=e.oxw(2);e.xp6(9),e.hij("",t.OrderDetails.totalOrderPrice," EGP"),e.xp6(7),e.Oqu(t.OrderDetails.paymentMethodType),e.xp6(7),e.hij(" ",e.lcZ(24,8,t.OrderDetails.isPaid)," "),e.xp6(8),e.Oqu(t.OrderDetails.shippingPrice),e.xp6(7),e.Oqu(t.OrderDetails.taxPrice),e.xp6(7),e.Oqu(e.lcZ(46,10,t.OrderDetails.createdAt)),e.xp6(8),e.hij(" ",t.OrderDetails.shippingAddress.details," "),e.xp6(7),e.Q6J("ngForOf",t.OrderDetails.cartItems)}}function O(r,s){if(1&r&&(e.TgZ(0,"div",8)(1,"div",9)(2,"div",10),e.YNc(3,f,3,1,"div",11),e.qZA()(),e.YNc(4,T,61,12,"div",12),e.qZA()),2&r){const t=e.oxw();e.xp6(3),e.Q6J("ngForOf",t.allOrders),e.xp6(1),e.Q6J("ngIf",t.showOrder)}}let q=(()=>{class r{constructor(t){this._OrdersService=t,this.userId=null,this.allOrders=[],this.OrderDetails={},this.showOrder=!1,this.noOrderMsg=!1}ngOnInit(){this.userId=localStorage.getItem("userId"),this.getUserOrders()}getUserOrders(){null!=this.userId&&this._OrdersService.getUserOrders(this.userId).subscribe({next:t=>{0==t.length?this.noOrderMsg=!0:(this.noOrderMsg=!1,this.allOrders=t)},error:t=>{console.log(t)}})}showDetils(t){for(let i=0;i<this.allOrders.length;i++)this.allOrders[i]._id==t&&(this.OrderDetails=this.allOrders[i]);this.showOrder=!0}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(u))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-orders"]],decls:5,vars:2,consts:[[1,"container","my-5","bg-main-light","py-5"],[1,"sec-heading","mb-5"],["class","text-center",4,"ngIf"],["class","row",4,"ngIf"],[1,"text-center"],[1,"fw-semibold","mb-0","fs-5"],[1,"btn","bg-main"],["routerLink","/home",1,"text-white"],[1,"row"],[1,"col-2"],[1,"main"],[4,"ngFor","ngForOf"],["class","col-10",4,"ngIf"],[1,"btn","btn-sm","main-btn","mb-2",3,"click"],[1,"col-10"],[1,"details"],["alt","product",1,"product-img","me-2",3,"src"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"h2",1),e._uU(2,"My Orders"),e.qZA(),e.YNc(3,Z,8,0,"div",2),e.YNc(4,O,5,2,"div",3),e.qZA()),2&t&&(e.xp6(3),e.Q6J("ngIf",i.noOrderMsg),e.xp6(1),e.Q6J("ngIf",!i.noOrderMsg))},dependencies:[p.sg,p.O5,c.rH,m,h],styles:[".product-img[_ngcontent-%COMP%]{width:28px}.details[_ngcontent-%COMP%]{font-size:16px}"]}),r})();var n=d(4006),v=d(4015),U=d(8482),C=d(910);function x(r,s){1&r&&(e.TgZ(0,"p"),e._uU(1," phone is required "),e.qZA())}function y(r,s){1&r&&(e.TgZ(0,"p"),e._uU(1," phone lenght is 11 nums & start with 01 as 01088888888 "),e.qZA())}function b(r,s){if(1&r&&(e.TgZ(0,"div",24),e.YNc(1,x,2,0,"p",23),e.YNc(2,y,2,0,"p",23),e.qZA()),2&r){const t=e.oxw();let i,o;e.xp6(1),e.Q6J("ngIf",null==(i=t.shippingAddress.get("phone"))?null:i.getError("required")),e.xp6(1),e.Q6J("ngIf",null==(o=t.shippingAddress.get("phone"))?null:o.getError("pattern"))}}function I(r,s){if(1&r&&(e.TgZ(0,"option"),e._uU(1),e.qZA()),2&r){const t=s.$implicit;e.xp6(1),e.Oqu(t.name)}}function P(r,s){1&r&&(e.TgZ(0,"p"),e._uU(1," city is required "),e.qZA())}function w(r,s){if(1&r&&(e.TgZ(0,"div",24),e.YNc(1,P,2,0,"p",23),e.qZA()),2&r){const t=e.oxw();let i;e.xp6(1),e.Q6J("ngIf",null==(i=t.shippingAddress.get("city"))?null:i.getError("required"))}}function D(r,s){if(1&r&&(e.TgZ(0,"option")(1,"ul")(2,"li",25),e._uU(3),e.qZA(),e.TgZ(4,"li",25),e._uU(5),e.qZA(),e.TgZ(6,"li",25),e._uU(7),e.qZA()()()),2&r){const t=s.$implicit;e.ekj("border-bottom",!s.last),e.xp6(3),e.hij("",t.name," /"),e.xp6(2),e.hij("",t.city," /"),e.xp6(2),e.Oqu(t.details)}}function F(r,s){1&r&&(e.TgZ(0,"p"),e._uU(1," details of Address is required "),e.qZA())}function S(r,s){if(1&r&&(e.TgZ(0,"div",24),e.YNc(1,F,2,0,"p",23),e.qZA()),2&r){const t=e.oxw();let i;e.xp6(1),e.Q6J("ngIf",null==(i=t.shippingAddress.get("details"))?null:i.getError("required"))}}function Y(r,s){1&r&&e._UZ(0,"i",26)}function N(r,s){1&r&&(e.TgZ(0,"span"),e._uU(1,"Pay"),e.qZA())}function J(r,s){if(1&r&&(e.TgZ(0,"p"),e._UZ(1,"img",9),e.TgZ(2,"span"),e._uU(3),e.qZA(),e.TgZ(4,"span"),e._uU(5),e.qZA()()),2&r){const t=s.$implicit;e.xp6(1),e.Q6J("src",t.product.imageCover,e.LSH),e.xp6(2),e.hij("",t.product.title," /"),e.xp6(2),e.hij("qty(",t.count,")")}}const M=[{path:"",component:q},{path:"checkout/:cartId",component:(()=>{class r{constructor(t,i,o,l,a,j){this._userAddressService=t,this._cityService=i,this._ordersService=o,this._CartService=l,this._activatedRoute=a,this._router=j,this.cityList=[],this.allAddresses=[],this.notValidForm=!1,this.isLoading=!1,this.cartId="",this.selectedPay="",this.shippingAddress=new n.cw({phone:new n.NI(null,[n.kI.required,n.kI.pattern(/^01[0125][0-9]{8}$/)]),city:new n.NI(null,[n.kI.required]),details:new n.NI(null,[n.kI.required])}),this._activatedRoute.paramMap.subscribe(G=>{this.cartId=G.params.cartId})}ngOnInit(){this.getcities(),this.getAddress()}getcities(){this._cityService.getcities().subscribe({next:t=>{this.cityList=t.results},error:t=>console.log(t)})}getAddress(){this._userAddressService.getUserAddresses().subscribe({next:t=>{this.allAddresses=t.data},error:t=>{console.log(t)}})}onSelected(t){this.selectedPay=t,this.selectedPay.includes("cash")?this.payCash(this.shippingAddress):this.payOnline(this.shippingAddress)}payCash(t){t.valid?(this.isLoading=!0,this._ordersService.createCashOrder(this.cartId,this.shippingAddress.value).subscribe({next:i=>{this.isLoading=!1,this._router.navigate(["/allorders/cashorder"]),this._CartService.noOfItems.next(0)},error:i=>{console.log(i)}})):this.notValidForm=!0}payOnline(t){t.valid?(this.isLoading=!0,this._ordersService.goToOnlinepayment(this.cartId,this.shippingAddress.value).subscribe({next:i=>{this.isLoading=!1,window.location.href=i.session.url}})):this.notValidForm=!0}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(v.k),e.Y36(U.Z),e.Y36(u),e.Y36(C.N),e.Y36(c.gz),e.Y36(c.F0))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-checkout"]],decls:35,vars:8,consts:[[1,"container","my-5"],[1,"main-form","w-50","mx-auto",3,"formGroup","ngSubmit"],["for","phone"],["type","tel","id","phone","formControlName","phone",1,"form-control","mb-4"],["class","text-danger mb-5",4,"ngIf"],[1,"city"],["for","city"],["aria-label","Default select example","id","city","formControlName","city",1,"form-select-sm","mb-4","mx-2"],[4,"ngFor","ngForOf"],[1,"detailsAdress"],["for","details"],["aria-label","Default select example","id","details","formControlName","details",1,"form-select-sm","mb-4","mx-2"],["selected",""],[3,"border-bottom",4,"ngFor","ngForOf"],["type","text","id","details","formControlName","details",1,"form-control","mb-4"],[1,"paymentmethod"],["for","payment"],["aria-label","Default select example","id","payment",1,"form-select-sm","mb-4","mx-2"],["payment",""],["value","cash"],["value","online"],["type","submit",1,"btn","bg-main","text-white","d-block","ms-auto"],["class","fa fa-spinner fa-spin me-2",4,"ngIf"],[4,"ngIf"],[1,"text-danger","mb-5"],[1,"mx-2"],[1,"fa","fa-spinner","fa-spin","me-2"]],template:function(t,i){if(1&t){const o=e.EpF();e.TgZ(0,"div",0)(1,"form",1),e.NdJ("ngSubmit",function(){e.CHM(o);const a=e.MAs(27);return e.KtG(i.onSelected(a.value))}),e.TgZ(2,"label",2),e._uU(3,"Phone :"),e.qZA(),e._UZ(4,"input",3),e.YNc(5,b,3,2,"div",4),e.TgZ(6,"div",5)(7,"label",6),e._uU(8,"City :"),e.qZA(),e.TgZ(9,"select",7),e.YNc(10,I,2,1,"option",8),e.qZA(),e.YNc(11,w,2,1,"div",4),e.qZA(),e.TgZ(12,"div",9)(13,"label",10),e._uU(14,"Address details : "),e.qZA(),e.TgZ(15,"select",11)(16,"option",12),e._uU(17,"No Address"),e.qZA(),e.YNc(18,D,8,5,"option",13),e.qZA(),e.TgZ(19,"div"),e._uU(20,"Or add another address"),e.qZA(),e._UZ(21,"input",14),e.YNc(22,S,2,1,"div",4),e.qZA(),e.TgZ(23,"div",15)(24,"label",16),e._uU(25,"Payment Method :"),e.qZA(),e.TgZ(26,"select",17,18)(28,"option",19),e._uU(29,"Cash Payment"),e.qZA(),e.TgZ(30,"option",20),e._uU(31,"Online Payment"),e.qZA()()(),e.TgZ(32,"button",21),e.YNc(33,Y,1,0,"i",22),e.YNc(34,N,2,0,"span",23),e.qZA()()()}if(2&t){let o,l,a;e.xp6(1),e.Q6J("formGroup",i.shippingAddress),e.xp6(4),e.Q6J("ngIf",(null==(o=i.shippingAddress.get("phone"))?null:o.errors)&&((null==(o=i.shippingAddress.get("phone"))?null:o.touched)||i.notValidForm)),e.xp6(5),e.Q6J("ngForOf",i.cityList),e.xp6(1),e.Q6J("ngIf",(null==(l=i.shippingAddress.get("city"))?null:l.errors)&&((null==(l=i.shippingAddress.get("city"))?null:l.touched)||i.notValidForm)),e.xp6(7),e.Q6J("ngForOf",i.allAddresses),e.xp6(4),e.Q6J("ngIf",(null==(a=i.shippingAddress.get("details"))?null:a.errors)&&((null==(a=i.shippingAddress.get("details"))?null:a.touched)||i.notValidForm)),e.xp6(11),e.Q6J("ngIf",i.isLoading),e.xp6(1),e.Q6J("ngIf",!i.isLoading)}},dependencies:[p.sg,p.O5,n._Y,n.YN,n.Kr,n.Fj,n.EJ,n.JJ,n.JL,n.sg,n.u]}),r})()},{path:"cashorder",component:(()=>{class r{constructor(t){this._OrdersService=t,this.userId=null,this.OrderDetails={}}ngOnInit(){this.userId=localStorage.getItem("userId"),this.getUserOrders()}getUserOrders(){null!=this.userId&&this._OrdersService.getUserOrders(this.userId).subscribe({next:t=>{this.OrderDetails=t[t.length-1]},error:t=>{console.log(t)}})}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(u))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-cashorder"]],decls:71,vars:12,consts:[[1,"container","my-5","bg-main-light","py-5"],[1,"fs-5","fw-bold","mb-4"],[1,"fa-sharp","fa-solid","fa-circle-check","me-2"],[1,"details"],[4,"ngFor","ngForOf"],[1,"mt-5"],[1,"fs-6"],[1,"btn","bg-main","btn-sm","mx-2"],["routerLink","/allorders",1,"text-white"],["alt","product",1,"product-img","me-2",3,"src"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"div",1),e._UZ(2,"i",2),e.TgZ(3,"span"),e._uU(4,"Your order is Done "),e.qZA()(),e.TgZ(5,"div",3)(6,"table")(7,"tr")(8,"td"),e._uU(9,"Total Order Price"),e.qZA(),e.TgZ(10,"td"),e._uU(11,":"),e.qZA(),e.TgZ(12,"td"),e._uU(13),e.qZA()(),e.TgZ(14,"tr")(15,"td"),e._uU(16,"Payment Method Type"),e.qZA(),e.TgZ(17,"td"),e._uU(18,":"),e.qZA(),e.TgZ(19,"td"),e._uU(20),e.qZA()(),e.TgZ(21,"tr")(22,"td"),e._uU(23,"Is Paid"),e.qZA(),e.TgZ(24,"td"),e._uU(25,":"),e.qZA(),e.TgZ(26,"td"),e._uU(27),e.ALo(28,"paidOrder"),e.qZA()(),e.TgZ(29,"tr")(30,"td"),e._uU(31,"Shipping Price"),e.qZA(),e.TgZ(32,"td"),e._uU(33,":"),e.qZA(),e.TgZ(34,"td"),e._uU(35),e.qZA()(),e.TgZ(36,"tr")(37,"td"),e._uU(38,"Tax Price"),e.qZA(),e.TgZ(39,"td"),e._uU(40,":"),e.qZA(),e.TgZ(41,"td"),e._uU(42),e.qZA()(),e.TgZ(43,"tr")(44,"td"),e._uU(45,"Created At"),e.qZA(),e.TgZ(46,"td"),e._uU(47,":"),e.qZA(),e.TgZ(48,"td"),e._uU(49),e.ALo(50,"getDate"),e.qZA()(),e.TgZ(51,"tr")(52,"td"),e._uU(53,"Shipping Address"),e.qZA(),e.TgZ(54,"td"),e._uU(55,":"),e.qZA(),e.TgZ(56,"td"),e._uU(57),e.qZA()(),e.TgZ(58,"tr")(59,"td"),e._uU(60,"Order Items"),e.qZA(),e.TgZ(61,"td"),e._uU(62,":"),e.qZA(),e.TgZ(63,"td"),e.YNc(64,J,6,3,"p",4),e.qZA()()(),e.TgZ(65,"div",5)(66,"span",6),e._uU(67,"If you want to see your previous orders"),e.qZA(),e.TgZ(68,"button",7)(69,"a",8),e._uU(70,"Click here"),e.qZA()()()()()),2&t&&(e.xp6(13),e.hij("",i.OrderDetails.totalOrderPrice," EGP"),e.xp6(7),e.Oqu(i.OrderDetails.paymentMethodType),e.xp6(7),e.hij(" ",e.lcZ(28,8,i.OrderDetails.isPaid)," "),e.xp6(8),e.Oqu(i.OrderDetails.shippingPrice),e.xp6(7),e.Oqu(i.OrderDetails.taxPrice),e.xp6(7),e.Oqu(e.lcZ(50,10,i.OrderDetails.createdAt)),e.xp6(8),e.hij(" ",i.OrderDetails.shippingAddress.details," "),e.xp6(7),e.Q6J("ngForOf",i.OrderDetails.cartItems))},dependencies:[p.sg,c.rH,m,h],styles:[".product-img[_ngcontent-%COMP%]{width:28px}.details[_ngcontent-%COMP%]{font-size:16px}"]}),r})()}];let L=(()=>{class r{}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({imports:[c.Bz.forChild(M),c.Bz]}),r})(),Q=(()=>{class r{}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({imports:[p.ez,L,n.UX,n.u5]}),r})()}}]);